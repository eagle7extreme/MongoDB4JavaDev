<html><head><title>Untitled document</title><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_ta60rrsegw2n-0>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-0}.lst-kix_ta60rrsegw2n-8>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-8,lower-roman) ". "}ol.lst-kix_ta60rrsegw2n-2.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-2 0}ol.lst-kix_ta60rrsegw2n-0{list-style-type:none}.lst-kix_ta60rrsegw2n-1>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-1,lower-latin) ". "}ol.lst-kix_ta60rrsegw2n-1{list-style-type:none}ol.lst-kix_ta60rrsegw2n-8.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-8 0}ol.lst-kix_ta60rrsegw2n-3.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-3 0}.lst-kix_ta60rrsegw2n-0>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-0,decimal) ". "}.lst-kix_nu2s93v3cmam-4>li:before{content:"\0025cb  "}.lst-kix_ta60rrsegw2n-5>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-5,lower-roman) ". "}.lst-kix_ta60rrsegw2n-6>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-6,decimal) ". "}.lst-kix_ta60rrsegw2n-2>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-2}.lst-kix_nu2s93v3cmam-0>li:before{content:"\0025cf  "}.lst-kix_ta60rrsegw2n-3>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-3,decimal) ". "}.lst-kix_nu2s93v3cmam-3>li:before{content:"\0025cf  "}.lst-kix_nu2s93v3cmam-5>li:before{content:"\0025a0  "}ol.lst-kix_ta60rrsegw2n-6.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-6 0}.lst-kix_nu2s93v3cmam-1>li:before{content:"\0025cb  "}.lst-kix_nu2s93v3cmam-7>li:before{content:"\0025cb  "}ol.lst-kix_ta60rrsegw2n-4.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-4 0}ul.lst-kix_nu2s93v3cmam-1{list-style-type:none}ul.lst-kix_nu2s93v3cmam-0{list-style-type:none}ul.lst-kix_nu2s93v3cmam-3{list-style-type:none}ul.lst-kix_nu2s93v3cmam-2{list-style-type:none}ul.lst-kix_nu2s93v3cmam-5{list-style-type:none}ul.lst-kix_nu2s93v3cmam-4{list-style-type:none}ul.lst-kix_nu2s93v3cmam-7{list-style-type:none}ul.lst-kix_nu2s93v3cmam-6{list-style-type:none}.lst-kix_ta60rrsegw2n-1>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-1}ul.lst-kix_nu2s93v3cmam-8{list-style-type:none}ol.lst-kix_ta60rrsegw2n-7.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-7 0}ol.lst-kix_ta60rrsegw2n-0.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-0 0}.lst-kix_ta60rrsegw2n-8>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-8}.lst-kix_nu2s93v3cmam-8>li:before{content:"\0025a0  "}ol.lst-kix_ta60rrsegw2n-5.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-5 0}.lst-kix_ta60rrsegw2n-3>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-3}.lst-kix_nu2s93v3cmam-2>li:before{content:"\0025a0  "}.lst-kix_ta60rrsegw2n-4>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-4}.lst-kix_ta60rrsegw2n-4>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-4,lower-latin) ". "}.lst-kix_ta60rrsegw2n-6>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-6}.lst-kix_ta60rrsegw2n-7>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-7}.lst-kix_ta60rrsegw2n-2>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-2,lower-roman) ". "}.lst-kix_nu2s93v3cmam-6>li:before{content:"\0025cf  "}.lst-kix_ta60rrsegw2n-7>li:before{content:"" counter(lst-ctn-kix_ta60rrsegw2n-7,lower-latin) ". "}.lst-kix_ta60rrsegw2n-5>li{counter-increment:lst-ctn-kix_ta60rrsegw2n-5}ol.lst-kix_ta60rrsegw2n-4{list-style-type:none}ol.lst-kix_ta60rrsegw2n-5{list-style-type:none}ol.lst-kix_ta60rrsegw2n-1.start{counter-reset:lst-ctn-kix_ta60rrsegw2n-1 0}ol.lst-kix_ta60rrsegw2n-2{list-style-type:none}ol.lst-kix_ta60rrsegw2n-3{list-style-type:none}ol.lst-kix_ta60rrsegw2n-8{list-style-type:none}ol.lst-kix_ta60rrsegw2n-6{list-style-type:none}ol.lst-kix_ta60rrsegw2n-7{list-style-type:none}ol{margin:0;padding:0}.c6{line-height:1.4;direction:ltr;margin-left:19pt;padding-bottom:27pt}.c1{color:#3c3c3c;font-size:12pt;background-color:#ffffff;font-weight:bold}.c3{line-height:1.375;direction:ltr;margin-left:19pt;padding-bottom:27pt}.c0{color:#3c3c3c;background-color:#f8f8f8;font-family:"Verdana"}.c2{line-height:1.4;direction:ltr;padding-bottom:11pt}.c13{color:#615f5e;background-color:#f8f8f8;font-family:"Verdana"}.c9{color:#615f5e;font-size:12pt;background-color:#ffffff}.c8{color:#3c3c3c;font-size:12pt;background-color:#ffffff}.c10{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c12{line-height:1.5;padding-bottom:17pt}.c4{color:#6ba539;font-size:15pt}.c11{line-height:1.4}.c14{padding-top:15pt}.c5{height:11pt}.c7{direction:ltr}.title{padding-top:0pt;line-height:1.15;text-align:left;color:#000000;font-size:21pt;font-family:"Trebuchet MS";padding-bottom:0pt}.subtitle{padding-top:0pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:13pt;font-family:"Trebuchet MS";padding-bottom:10pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:16pt;font-family:"Trebuchet MS";padding-bottom:0pt}h2{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:13pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt}h3{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:12pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt}h4{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:11pt;text-decoration:underline;font-family:"Trebuchet MS";padding-bottom:0pt}h5{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt}h6{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt}</style></head><body class="c10"><h2 class="c2"><a name="h.6cb0dh4uhm6d"></a><span class="c4">Final: Final.5</span></h2><p class="c7 c12"><span class="c9">Suppose we have blog posts in a (not sharded*) postings collection, of the form:</span></p><p class="c7 c11"><span class="c13">{<br> &nbsp;_id : &hellip;,<br> &nbsp;author : &#39;joe&#39;,<br> &nbsp;title : &#39;Too big to fail&#39;,<br> &nbsp;text : &hellip;,<br> &nbsp;tags : [ &#39;business&#39;, &#39;finance&#39; ],<br> &nbsp;when : ISODate(&quot;2008-11-03&quot;),<br> &nbsp;views : 23002,<br> &nbsp;votes : 4,<br> &nbsp;voters : [&#39;joe&#39;, &#39;jane&#39;, &#39;bob&#39;, &#39;somesh&#39;],<br> &nbsp;comments : [<br> &nbsp; &nbsp;{ commenter : &#39;allan&#39;, <br> &nbsp; &nbsp; &nbsp;comment : &#39;Well, i don&#39;t think so&hellip;&#39;, <br> &nbsp; &nbsp; &nbsp;flagged:false, plus:2 },<br> &nbsp; &nbsp;...<br> &nbsp;]<br>}<br></span></p><p class="c12 c7"><span class="c9">Which of these statements is true? Note: to get a multiple answer question right in this final you must get all the components right, so even if some parts are simple, take your time.</span></p><p class="c12 c7 c14"><span class="c9">*Certain restrictions apply to unique constraints on indexes when sharded, so I mention this to be clear.</span></p><p class="c3"><span class="c1">A. </span><span class="c8">We can create an index to make the query fast/faster:</span></p><p class="c6"><span class="c0">db.postings.find( { &quot;comments.flagged&quot; : true } )</span></p><p class="c3"><span class="c1">B.</span><span class="c8">&nbsp;</span><span class="c8">One way to assure people vote at most once per posting is to use this form of update:</span></p><p class="c6"><span class="c0">db.postings.update( <br> &nbsp;{ _id:&hellip; }, <br> &nbsp;{ $inc : {votes:1}, $push : {voters:&#39;joe&#39;} } );<br></span></p><p class="c3"><span class="c8">combined with an index on { voters : 1 } which has a unique key constraint.</span></p><p class="c3"><span class="c1">C.</span><span class="c8">&nbsp;One way to assure people vote at most once per posting is to use this form of update:</span></p><p class="c6"><span class="c0">db.postings.update( <br> &nbsp;{ _id:&hellip; , voters:{$ne:&#39;joe&#39;} },<br> &nbsp;{ $inc : {votes:1}, $push : {voters:&#39;joe&#39;} } );<br></span></p><p class="c6"><span class="c0">Ans: </span></p><p class="c6"><span class="c0">A, B</span></p><p class="c3 c5"><span class="c0"></span></p><p class="c5 c7"><span></span></p></body></html>