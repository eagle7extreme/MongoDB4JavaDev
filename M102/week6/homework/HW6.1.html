<html><head><title>Untitled document</title><style type="text/css">ol{margin:0;padding:0}.c9{line-height:1.375;direction:ltr;margin-left:22pt;padding-bottom:8pt}.c12{color:#1d4595;font-size:12pt;background-color:#ffffff;font-family:"Verdana"}.c4{line-height:1.4;direction:ltr;margin-left:22pt;padding-bottom:8pt}.c2{line-height:1.6000000000000003;padding-top:15pt;direction:ltr;padding-bottom:17pt}.c5{line-height:1.0;padding-top:15pt;direction:ltr;padding-bottom:17pt}.c10{color:#646464;font-size:20pt;background-color:#ffffff;font-family:"Verdana"}.c0{color:#3c3c3c;font-size:12pt;background-color:#ffffff;font-family:"Verdana"}.c6{color:#222222;font-size:12pt;background-color:#ffffff;font-family:"Verdana"}.c8{line-height:1.6000000000000003;direction:ltr;padding-bottom:17pt}.c1{color:#222222;background-color:#f8f8f8;font-family:"Verdana"}.c7{color:#3c3c3c;background-color:#f8f8f8;font-family:"Verdana"}.c11{line-height:1.2;direction:ltr;padding-bottom:11pt}.c13{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c15{color:inherit;text-decoration:inherit}.c3{height:11pt;direction:ltr}.c14{font-style:italic}.title{padding-top:0pt;line-height:1.15;text-align:left;color:#000000;font-size:21pt;font-family:"Trebuchet MS";padding-bottom:0pt}.subtitle{padding-top:0pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:13pt;font-family:"Trebuchet MS";padding-bottom:10pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:16pt;font-family:"Trebuchet MS";padding-bottom:0pt}h2{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:13pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt}h3{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:12pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt}h4{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:11pt;text-decoration:underline;font-family:"Trebuchet MS";padding-bottom:0pt}h5{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt}h6{padding-top:8pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt}</style></head><body class="c13"><h2 class="c11"><span class="c10">Homework: Homework 6.1</span></h2><p class="c8"><span class="c0">For this week&#39;s homework we will start with a standalone MongoDB database, turn it into a sharded cluster with two shards, and shard one of the collections. We will create a &quot;dev&quot; environment on our local box: no replica sets, and only one config server. In production you would almost always use three config servers and replica sets as part of a sharded cluster. In the final of the course we&#39;ll set up a larger cluster with replica sets and three config servers.</span></p><p class="c5"><span class="c0">Download </span><span class="c12"><a class="c15" href="https://education.10gen.com/static/m102-july-2013/handouts/week6.b2784a6c05a1.js">week6.js</a></span><span class="c0">.</span></p><p class="c2"><span class="c0">Start an initially empty </span><span class="c7">mongod</span><span class="c0">&nbsp;database instance.</span></p><p class="c9"><span class="c6">Connect to it with the shell and week6.js loaded:</span></p><p class="c4"><span class="c1">mongo --shell localhost/week6 week6.js<br></span></p><p class="c9"><span class="c6">Run </span><span class="c1">homework.init()</span><span class="c6">. It will take some time to run as it inserts quite a few documents. When it is done run</span></p><p class="c4"><span class="c1">db.trades.stats()<br></span></p><p class="c9"><span class="c6">to check the status of the collection. </span></p><p class="c8"><span class="c0">At this point we have a single mongod and would like to transform it into a sharded cluster with one shard. (We&#39;ll use this node&rsquo;s existing </span><span class="c7">week6.trades</span><span class="c0">&nbsp;data in the cluster.)</span></p><p class="c2"><span class="c0">Stop the mongod process. Now, restart the mongod process adding the option </span><span class="c7">--shardsvr</span><span class="c0">. If you started mongod with a </span><span class="c7">--dbpath</span><span class="c0">&nbsp;option, specify that as well.</span></p><p class="c4"><span class="c1">mongod --shardsvr &hellip;<br></span></p><p class="c8"><span class="c0">Note that with --shardsvr specified the default port for mongod becomes 27018.</span></p><p class="c2"><span class="c0">Start a mongo config server:</span></p><p class="c4"><span class="c1">mongod --configsvr &hellip;<br></span></p><p class="c9"><span class="c6">(Note with </span><span class="c1">--configsvr</span><span class="c6">&nbsp;specified the default port for listening becomes 27019 and the default data directory /data/configdb. Wherever your data directory is, it is suggested that you verify that the directory is empty before you begin.)</span></p><p class="c8"><span class="c0">Start a mongos:</span></p><p class="c4"><span class="c1">mongos --configdb your_host_name:27019<br></span></p><p class="c9"><span class="c6">Connect to mongos with the shell:</span></p><p class="c4"><span class="c1">mongo --shell localhost/week6 week6.js<br></span></p><p class="c9"><span class="c6">Add the first shard (&quot;</span><span class="c6 c14">your_host_name</span><span class="c6">:27018&quot;).</span></p><p class="c8"><span class="c0">Verify that the week6.trades data is visible via mongos. Note at this point the week6 database isn&#39;t &quot;sharding enabled&quot; but its data is still visible via mongos:</span></p><p class="c4"><span class="c1">&gt; db.trades.find().pretty()<br>&gt; db.trades.count()<br>&gt; db.trades.stats()<br></span></p><p class="c4"><span class="c6">Run homework.a() and enter the result below. This method will simply verify that this simple cluster is up and running and return a result key.</span></p><p class="c3"><span class="c10"></span></p></body></html>